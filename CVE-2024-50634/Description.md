A vulnerability in a weak JWT token in Watcharr v1.43.0 and below allows attackers to perform privilege escalation using a crafted JWT token. This vulnerability is not limited to privilege escalation but also affects all functions that require authentication.

[VulnerabilityType Other] 
 
 Privilege Escalation

[Vendor of Product]

sbondCo

[Affected Product Code Base]

Watcharr - v1.43.0

[Affected Component]

The vulnerability is affected all functions that required authentication.

[Attack Type]

Remote

[Impact Escalation of Privileges]

true

[Attack Vectors]

Reproduction steps

1.Login as a user to obtain user JWT token.

2.Reverse engineering user JWT token to obtain valid admin JWT token.

3.Access /api/server/users/userId. In Authorization, change user JWT token to crafted JWT token.

5.Permission can be change to 3(admin/full access), 5(Request Content) or 9(Auto Approve Content Request)

6.Exploited

[Reference]

https://github.com/sbondCo/Watcharr

https://youtu.be/wnULru0WdtA

[Has vendor confirmed or acknowledged the vulnerability?]

true

[Discoverer]

Suphawith Phusanbai
